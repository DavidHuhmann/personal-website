import{p as K}from"./chunk-A3B2PVJP.js";import{B as R,E as O,I as W,R as N,S as $,U as S,X as h,Ya as U,_ as l,a as m,ca as G,cb as q,cc as Z,d as I,e as z,f as D,h as C,k as b,ka as F,l as L,la as V,m as y,n as v,o as x,pb as J,s as A,sa as f,ta as H,u as M,ya as B}from"./chunk-YPBMTRLQ.js";var te={url:"",deserializer:o=>JSON.parse(o.data),serializer:o=>JSON.stringify(o)},ne="WebSocketSubject.error must be called with an object with an error code, and an optional reason: { code: number, reason: string }",w=class o extends L{constructor(e,t){if(super(),this._socket=null,e instanceof C)this.destination=t,this.source=e;else{let n=this._config=Object.assign({},te);if(this._output=new b,typeof e=="string")n.url=e;else for(let s in e)e.hasOwnProperty(s)&&(n[s]=e[s]);if(!n.WebSocketCtor&&WebSocket)n.WebSocketCtor=WebSocket;else if(!n.WebSocketCtor)throw new Error("no WebSocket constructor can be found");this.destination=new v}}lift(e){let t=new o(this._config,this.destination);return t.operator=e,t.source=this,t}_resetState(){this._socket=null,this.source||(this.destination=new v),this._output=new b}multiplex(e,t,n){let s=this;return new C(i=>{try{s.next(e())}catch(a){i.error(a)}let r=s.subscribe({next:a=>{try{n(a)&&i.next(a)}catch(c){i.error(c)}},error:a=>i.error(a),complete:()=>i.complete()});return()=>{try{s.next(t())}catch(a){i.error(a)}r.unsubscribe()}})}_connectSocket(){let{WebSocketCtor:e,protocol:t,url:n,binaryType:s}=this._config,i=this._output,r=null;try{r=t?new e(n,t):new e(n),this._socket=r,s&&(this._socket.binaryType=s)}catch(c){i.error(c);return}let a=new z(()=>{this._socket=null,r&&r.readyState===1&&r.close()});r.onopen=c=>{let{_socket:p}=this;if(!p){r.close(),this._resetState();return}let{openObserver:P}=this._config;P&&P.next(c);let _=this.destination;this.destination=D.create(u=>{if(r.readyState===1)try{let{serializer:g}=this._config;r.send(g(u))}catch(g){this.destination.error(g)}},u=>{let{closingObserver:g}=this._config;g&&g.next(void 0),u&&u.code?r.close(u.code,u.reason):i.error(new TypeError(ne)),this._resetState()},()=>{let{closingObserver:u}=this._config;u&&u.next(void 0),r.close(),this._resetState()}),_&&_ instanceof v&&a.add(_.subscribe(this.destination))},r.onerror=c=>{this._resetState(),i.error(c)},r.onclose=c=>{r===this._socket&&this._resetState();let{closeObserver:p}=this._config;p&&p.next(c),c.wasClean?i.complete():i.error(c)},r.onmessage=c=>{try{let{deserializer:p}=this._config;i.next(p(c))}catch(p){i.error(p)}}}_subscribe(e){let{source:t}=this;return t?t.subscribe(e):(this._socket||this._connectSocket(),this._output.subscribe(e),e.add(()=>{let{_socket:n}=this;this._output.observers.length===0&&(n&&(n.readyState===1||n.readyState===0)&&n.close(),this._resetState())}),e)}unsubscribe(){let{_socket:e}=this;e&&(e.readyState===1||e.readyState===0)&&e.close(),this._resetState(),super.unsubscribe()}};function E(o){return new w(o)}var k={production:!0,defaultLanguage:"en-US",supportedLanguages:["en-US","de-DE"],discord:{userId:"137259014986792960",socket:"wss://api.dqvid.dev/socket"}};var Y=class o{webSocket;stop$=new b;dataSubject$=new y(null);heartbeat$=R(25e3);constructor(){this.webSocket=this.createWebSocket(),this.start()}createWebSocket(){return E(k.discord.socket)}start(){this.webSocket.pipe(N(this.stop$),$(e=>this.handleServerMessage(e)),M(e=>this.mapStringArrayToData(e)),W(),O(e=>(console.error("WebSocket Error:",e),x))).subscribe({next:e=>this.dataSubject$.next(e),error:e=>console.error("Unhandled WebSocket Error:",e),complete:()=>console.log("WebSocket connection closed.")})}handleServerMessage(e){e.op===1&&this.initiateHandshake()}initiateHandshake(){this.webSocket.next({op:2,d:{subscribe_to_ids:[k.discord.userId]}}),this.heartbeat$.pipe(N(this.stop$)).subscribe(()=>this.webSocket.next({op:3}))}mapStringArrayToData(e){return e.t==="INIT_STATE"?e.d[k.discord.userId]:e.d}getUserData(){return this.dataSubject$.asObservable()}convertMpUrlToImgUrl(e){let t=e.match(/\/https?\/(.+)$/);if(!t)return null;let n="https://"+t[1];return decodeURIComponent(n)}sendMessage(e){this.webSocket.next(e)}ngOnDestroy(){this.stop$.next(),this.stop$.complete(),this.dataSubject$.complete(),this.webSocket.complete()}static \u0275fac=function(t){return new(t||o)};static \u0275prov=S({token:o,factory:o.\u0275fac,providedIn:"root"})};var rt=new h("Ng Glyph Config");var st=new h("NgGlyphsToken");function oe(o){return o==null?"":/^\d+$/.test(o)?`${o}px`:o}var ie=new h("Ng Icon Pre Processor"),re=new h("Ng Icon Post Processor");function se(){return l(ie,{optional:!0})??(o=>o)}function ce(){return l(re,{optional:!0})??(()=>{})}var ae=new h("Ng Icon Logger"),j=class{log(e){console.log(e)}warn(e){console.warn(e)}error(e){console.error(e)}};function le(){return l(ae,{optional:!0})??new j}var he=new h("Ng Icon Config");function ue(){return l(he,{optional:!0})??{}}var pe=new h("Ng Icon Loader Token");var de=new h("Ng Icon Cache Token");function ge(){return l(pe,{optional:!0})}function fe(){return l(de,{optional:!0})}function ct(o){return[{provide:T,useFactory:(e=l(T,{optional:!0,skipSelf:!0}))=>m(m({},e?.reduce((t,n)=>m(m({},t),n),{})),o),multi:!0}]}var T=new h("Icons Token");function me(){return l(T,{optional:!0})??[]}function be(o){return typeof o=="string"?Promise.resolve(o):A(o)?o.toPromise():o}function ye(o){return o.replace(/([^a-zA-Z0-9])+(.)?/g,(e,t,n)=>n?n.toUpperCase():"").replace(/[^a-zA-Z\d]/g,"").replace(/^([A-Z])/,e=>e.toLowerCase())}var ve=0,at=(()=>{class o{constructor(){this.config=ue(),this.icons=me(),this.loader=ge(),this.cache=fe(),this.preProcessor=se(),this.postProcessor=ce(),this.injector=l(F),this.renderer=l(U),this.platform=l(B),this.elementRef=l(H),this.uniqueId=ve++,this.logger=le(),this.name=f(),this.svg=f(),this.size=f(this.config.size,{transform:oe}),this.strokeWidth=f(this.config.strokeWidth),this.color=f(this.config.color),Z(()=>this.updateIcon()),l(new V("aria-hidden"),{optional:!0})||this.elementRef.nativeElement.setAttribute("aria-hidden","true")}ngOnDestroy(){this.svgElement=void 0}updateIcon(){return I(this,null,function*(){let t=this.name(),n=this.svg();if(n!==void 0){this.setSvg(n);return}if(t===void 0)return;let s=ye(t);for(let i of[...this.icons].reverse())if(i[s]){this.setSvg(i[s]);return}if(this.loader){let i=yield this.requestIconFromLoader(t);if(i!==null){this.setSvg(i);return}}this.logger.warn(`No icon named ${t} was found. You may need to import it using the withIcons function.`)})}setSvg(t){if(K(this.platform)){this.elementRef.nativeElement.innerHTML=t,this.elementRef.nativeElement.setAttribute("data-ng-icon-ssr","");return}if(this.elementRef.nativeElement.hasAttribute("data-ng-icon-ssr")&&(this.elementRef.nativeElement.removeAttribute("data-ng-icon-ssr"),this.svgElement=this.elementRef.nativeElement.querySelector("svg")??void 0,this.elementRef.nativeElement.innerHTML===t)||(this.svgElement&&this.renderer.removeChild(this.elementRef.nativeElement,this.svgElement),t===""))return;let n=this.renderer.createElement("template");t=this.replaceIds(t),this.renderer.setProperty(n,"innerHTML",this.preProcessor(t)),this.svgElement=n.content.firstElementChild,this.postProcessor(this.svgElement),this.renderer.appendChild(this.elementRef.nativeElement,this.svgElement)}replaceIds(t){if(!t.includes("ID_PLACEHOLDER_"))return t;let n=/ID_PLACEHOLDER_(\d+)/g,s=new Map,i=new Set(t.match(n));if(i===null)return t;for(let r of i){let a=r.replace("ID_PLACEHOLDER_",""),c=`ng-icon-${this.uniqueId}-${s.size}`;s.set(a,c),t=t.replace(new RegExp(r,"g"),c)}return t}requestIconFromLoader(t){return new Promise(n=>{G(this.injector,()=>I(this,null,function*(){if(this.cache){let r=this.cache.get(t);if(typeof r=="string"){n(r);return}if(r instanceof Promise){let a=yield r;n(a);return}}let s=be(this.loader(t));this.cache?.set(t,s);let i=yield s;this.cache?.set(t,i),n(i)}))})}static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275cmp=q({type:o,selectors:[["ng-icon"]],hostAttrs:["role","img"],hostVars:6,hostBindings:function(n,s){n&2&&J("--ng-icon__stroke-width",s.strokeWidth())("--ng-icon__size",s.size())("--ng-icon__color",s.color())},inputs:{name:[1,"name"],svg:[1,"svg"],size:[1,"size"],strokeWidth:[1,"strokeWidth"],color:[1,"color"]},decls:0,vars:0,template:function(n,s){},styles:["[_nghost-%COMP%]{display:inline-block;width:var(--ng-icon__size, 1em);height:var(--ng-icon__size, 1em);line-height:initial;vertical-align:initial;overflow:hidden}[_nghost-%COMP%]     svg{width:inherit;height:inherit;vertical-align:inherit}@layer ng-icon{[_nghost-%COMP%]{color:var(--ng-icon__color, currentColor)}}"],changeDetection:0})}}return o})();var X=(t=>(t.Light="light_mode",t.Dark="dark_mode",t))(X||{});var ee=class o{themeSubject=new y(localStorage.getItem("theme"));theme$=this.themeSubject.asObservable();getPreferredScheme=()=>window?.matchMedia?.("(prefers-color-scheme:dark)")?.matches?"dark":"light";load(){localStorage.getItem("theme")?this.setTheme(localStorage.getItem("theme")):this.getPreferredScheme()==="dark"?this.setTheme("dark_mode"):this.setTheme("light_mode")}setTheme(e){switch(e){case"dark_mode":document.body.dataset.theme="dark",localStorage.setItem("theme","dark_mode"),this.themeSubject.next("dark_mode");break;case"light_mode":document.body.dataset.theme="",localStorage.setItem("theme","light_mode"),this.themeSubject.next("light_mode");break}}toggleTheme(){let e=this.getCurrentTheme();this.setTheme(e==="light_mode"?"dark_mode":"light_mode")}getCurrentTheme(){return localStorage.getItem("theme")}static \u0275fac=function(t){return new(t||o)};static \u0275prov=S({token:o,factory:o.\u0275fac,providedIn:"root"})};export{k as a,Y as b,ct as c,at as d,X as e,ee as f};
